# Поддерживающие системы Neira

## InteractionHub
Единый оркестратор, через который проходят все запросы пользователя. Он регистрирует события, проверяет права доступа и направляет обращения к нужным узлам. InteractionHub агрегирует ответы ActionNode и MemoryNode, связывая их с исходным контекстом и формируя итоговый результат.

```rust
struct InteractionHub {
    sessions: HashMap<SessionId, Context>,
    log: EventLog,
}
```

## TaskScheduler
Планировщик распределяет задачи по очередям `fast`, `standard` и `long` в зависимости от оценки длительности. AnalysisNode передаёт задачу в соответствующий канал, а Scheduler отвечает за параллелизм и контроль квот.

```toml
[scheduler]
fast = 60_000       # 1 минута
standard = 1_800_000 # 30 минут
long = 28_800_000    # 8 часов
```

## Рабочая память
Временное хранилище актуального контекста. Содержит последние сообщения, переменные запроса и результаты промежуточных вычислений. Записи автоматически вытесняются по таймеру или при переполнении лимита.

## Модуль эмоций
Следит за тоном диалога и внутренним состоянием системы. Положительные сигналы усиливают инициативность, негативные — вызывают осторожность и запрос на уточнение. Эмоции не влияют на логику вывода, но помогают выбирать стиль ответа.

## Уведомления о прогрессе
Для задач класса `standard` и `long` InteractionHub отправляет промежуточные сообщения о ходе выполнения. Scheduler выдаёт процент готовности, который отображается пользователю. После завершения задача помечается в журнале и из рабочей памяти удаляются временные записи.
