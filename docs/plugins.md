# API плагинов

Плагины позволяют расширять систему новыми типами блоков и другой функциональностью.
Термины см. в [глоссарии](glossary.md). 
Основная логика плагина находится на стороне backend и реализует трейт `Plugin`.

## Backend API

```rust
pub trait Plugin: Send + Sync {
    fn name(&self) -> &'static str;
    fn version(&self) -> &str;
    fn blocks(&self) -> Vec<BlockDescriptor>;
}
```

`BlockDescriptor` описывает тип блока, который предоставляет плагин: идентификатор
вида, человекочитаемую метку и версию реализации.

## WebAssembly плагины

Backend может загружать плагины, собранные в WebAssembly, через
`WasmPlugin::from_file`. Модуль должен экспортировать функции `memory`,
`name`, `version` и `blocks`, каждая из которых возвращает указатель и длину
UTF‑8 строки внутри памяти. Память ограничена одним страницей (64 КиБ).

## Отличия от старого фронтенда

- Раньше плагины представляли собой JavaScript‑модули, реализующие интерфейс
  `VizPlugin` с методом `register` и автоматически загружаемые из каталога
  `plugins/`.
- В новой системе плагин регистрируется на backend через трейт `Plugin`, а
  фронтенд лишь получает описания блоков (`BlockDescriptor`) и подключает
  соответствующие визуальные компоненты.
- Плагины могут распространяться как WebAssembly‑модули без доступа к API
  браузера.
